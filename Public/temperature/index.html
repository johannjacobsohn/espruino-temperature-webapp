<!doctype html>
<html>
	<head>
		<title>How is Johann?</title>
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
		<style>
			body{
				font-family: "Raleway", Calibri, Candara, Arial, sans-serif;
				background-image: url(data:image/png;base64,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);
				-background-color: #0094d0;
			}
			canvas{
				width: 90%;
				margin: auto;
				position: absolute;
				bottom: 0;
				height: 90vh;
				left: 0px;
				z-index: -1;
			}
			h1{
				text-align: center;

				font-size: 9vw;
				text-shadow: 1px 1px 2px rgb(204, 204, 204);
				font-weight: lighter;

				font-size: 8vw;
				text-shadow: 0 1px 0 #ccc, 0 2px 0 #c9c9c9, 0 3px 0 #bbb, 0 4px 0 #b9b9b9, 0 5px 0 #aaa, 0 6px 1px rgba(0,0,0,.1), 0 0 5px rgba(0,0,0,.1), 0 1px 3px rgba(0,0,0,.3), 0 3px 5px rgba(0,0,0,.2), 0 5px 10px rgba(0,0,0,.25), 0 10px 10px rgba(0,0,0,.2), 0 20px 20px rgba(0,0,0,.15);
				color: white;
			}
			p span{
				font-weight: bold;
				display: block;
				font-size: 20vw;
				text-align: right;
				position: absolute;
				bottom: 25%;
				right: 5%;
				opacity: 0;
			}

			.loader {
				margin: 60px auto;
				font-size: 10px;
				position: relative;
				text-indent: -9999em;
				border-top: 1.1em solid rgba(255, 255, 255, 0.2);
				border-right: 1.1em solid rgba(255, 255, 255, 0.2);
				border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
				border-left: 1.1em solid #ffffff;
				-webkit-transform: translateZ(0);
				-ms-transform: translateZ(0);
				transform: translateZ(0);
				-webkit-animation: load8 1.1s infinite linear;
				animation: load8 1.1s infinite linear;
				-webkit-transition: 1s opacity;
				transition: 1s opacity;
			}
			.loader,
			.loader:after {
				border-radius: 50%;
				width: 10em;
				height: 10em;
			}

			.dead .loader,
			.hot .loader,
			.fine .loader,
			.cold .loader {
				opacity: 0;
			}

			@-webkit-keyframes load8 {
				0% {
					-webkit-transform: rotate(0deg);
					transform: rotate(0deg);
				}
				100% {
					-webkit-transform: rotate(360deg);
					transform: rotate(360deg);
				}
			}
			@keyframes load8 {
				0% {
					-webkit-transform: rotate(0deg);
					transform: rotate(0deg);
				}
				100% {
					-webkit-transform: rotate(360deg);
					transform: rotate(360deg);
				}
			}

			.dead p span,
			.hot p span,
			.fine p span,
			.cold p span {
				-webkit-animation-duration: .5s;
				animation-duration: .5s;
				-webkit-animation-fill-mode: both;
				animation-fill-mode: both;
				-webkit-animation-name: zoomIn;
				animation-name: zoomIn;
			}

			body .out-of-office{
				display: none;
				font-size: 4vw;
				text-align: center;

				color: lightgray;

				text-shadow: 0px 0px 2px gray;
			}
			.out-of-office .out-of-office{
				display: block;
			}

			.dead p span{
				color: #d7191c;
				text-shadow: 6px 6px 30px black, -6px 6px 30px black;
			}
			.dead p span::before{
				content: "‚ò†"
			}
			.hot p span{
				color: #fdae61;
				text-shadow: 4px 4px 10px red, -4px -4px 10px red, -4px 4px 10px yellow, 4px -4px 10px yellow;
			}
			.hot p span::before{
				content: "üî•"
			}
			.fine p span{
				color: #a6d96a;
				text-shadow: 1px 0px 1px #ccc, 0px 1px 1px #eee, 2px 1px 1px #ccc, 1px 2px 1px #eee, 3px 2px 1px #ccc, 2px 3px 1px #eee, 4px 3px 1px #ccc, 3px 4px 1px #eee, 5px 4px 1px #ccc, 4px 5px 1px #eee, 6px 5px 1px #ccc, 5px 6px 1px #eee, 7px 6px 1px #ccc;
				text-shadow: 0 1px 0px #378ab4, 1px 0 0px #5dabcd, 1px 2px 1px #378ab4, 2px 1px 1px #5dabcd, 2px 3px 2px #378ab4, 3px 2px 2px #5dabcd, 3px 4px 2px #378ab4, 4px 3px 3px #5dabcd, 4px 5px 3px #378ab4, 5px 4px 2px #5dabcd, 5px 6px 2px #378ab4, 6px 5px 2px #5dabcd, 6px 7px 1px #378ab4, 7px 6px 1px #5dabcd, 7px 8px 0px #378ab4, 8px 7px 0px #5dabcd;
			}
			.fine p span::before{
				content: "‚úì"
			}
			.cold p span{
				color: #abd9e9;
				text-shadow: 0 1px 0px #378ab4, 1px 0 0px #5dabcd, 1px 2px 1px #378ab4, 2px 1px 1px #5dabcd, 2px 3px 2px #378ab4, 3px 2px 2px #5dabcd, 3px 4px 2px #378ab4, 4px 3px 3px #5dabcd, 4px 5px 3px #378ab4, 5px 4px 2px #5dabcd, 5px 6px 2px #378ab4, 6px 5px 2px #5dabcd, 6px 7px 1px #378ab4, 7px 6px 1px #5dabcd, 7px 8px 0px #378ab4, 8px 7px 0px #5dabcd;
			}
			.cold p span::before{
				content: "‚ùÑ"
			}

			@-webkit-keyframes zoomIn {
				from {
					opacity: 0;
					-webkit-transform: scale3d(.3, .3, .3);
					transform: scale3d(.3, .3, .3);
				}

				to {
					opacity: 1;
				}
			}

			@keyframes zoomIn {
				from {
					opacity: 0;
					-webkit-transform: scale3d(.3, .3, .3);
					transform: scale3d(.3, .3, .3);
				}

				to {
					opacity: 1;
				}
			}
		</style>
	</head>
	<body>
		<h1>How is Johann today?</h1>
		<p class="out-of-office">(He is not his the office so he is probably)</p>
		<p><span></span></p>
		<div class="loader"></div>
		<canvas id="temperature"></canvas>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.1.2/papaparse.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.min.js"></script>
		<script>
			// put everything in the html, because i can!
			var ctx = document.getElementById("temperature");
			var stat = document.querySelector("p span");
			//~ ctx.width = document.innerWidth;
			//~ ctx.heigth = document.innerHeight;

			ctx.width = window.innerWidth
			ctx.height = window.innerHeight

			Papa.parse("datafile.csv", {
				dynamicTyping: true,
				download: true,
				skipEmptyLines: true,
				complete: function(results) {
					var data = results.data.map(function(item){ return {x: new Date(item[0]*1000), y: item[2]/1} })

					var currentTemp = data[data.length-1].y
					var lastTime = data[data.length-1].x
					if( moment(lastTime).diff(moment()) < -60*60*1000 ){
						// no current temperature available, assume the worst
						currentTemp = 90
						document.body.classList.add("out-of-office")
					}
					if(currentTemp > 32) status = "dead"
					else if(currentTemp > 28) status = "hot"
					else if(currentTemp > 20) status = "fine"
					else status = "cold"

					stat.innerText = status
					document.body.classList.add(status)

					chart(data);
				}
			});

			function chart(data){
				Chart.defaults.global.legend.display = false;
				new Chart(ctx, {
					type: 'line',
					data: {
						datasets: [{
							label: 'Office Temperature',
							data: data,
							backgroundColor : "rgba(235,145,145,.5)",
							borderColor :  "rgb(180,100,100)",
							pointColor : "#424647",
							pointBorderColor :  "rgb(180,100,100)"
						}]
					},
					options: {
						maintainAspectRatio: true,
						responsive: true,
						scales: {
							xAxes: [{
								type: 'time',
								time: {
									displayFormats: {
										quarter: 'MMM YYYY'
									}
								}
							}],
							yAxes: [{
								ticks: {
									//~ min: 20,
									//~ max: 50,
								}
							}]
						}
					}
				})
			}
		</script>
	</body>
</html>
